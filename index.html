<!DOCTYPE html>
<html lang="en">

<head>
    <title>Camera Capture</title>
</head>

<body>
    <button id="captureButton">拍照</button>
    <video id="cameraPreview" autoplay></video>
    <img id="capturedImage" style="display: none;">
    
    <script>
        const captureButton = document.getElementById('captureButton');
        const cameraPreview = document.getElementById('cameraPreview');
        const capturedImage = document.getElementById('capturedImage');
        
        captureButton.addEventListener('click', async () => {
            try {
                const mediaStream = await navigator.mediaDevices.getUserMedia({ video: true });
                
                cameraPreview.srcObject = mediaStream;
                cameraPreview.play();

                // 在拍照按钮点击时，获取当前视频帧作为图片
                const canvas = document.createElement('canvas');
                const minSize = Math.min(cameraPreview.videoWidth, cameraPreview.videoHeight);
                canvas.width = minSize;
                canvas.height = minSize;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(cameraPreview, (cameraPreview.videoWidth - minSize) / 2, (cameraPreview.videoHeight - minSize) / 2, minSize, minSize, 0, 0, minSize, minSize);

                const capturedImageDataURL = canvas.toDataURL('image/jpeg');

                // 将捕捉到的照片展示在瀏覽器上
                capturedImage.src = capturedImageDataURL;
                capturedImage.style.display = 'block';

                // 关闭摄像头视频流
                mediaStream.getTracks().forEach(track => track.stop());
            } catch (error) {
                console.error('Error accessing camera:', error);
            }
        });
    </script>
</body>

</html>
